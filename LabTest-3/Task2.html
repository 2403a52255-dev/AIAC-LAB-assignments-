<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Dynamic Product List</title>
    <style>
        :root{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;margin:0;padding:0}
        body{padding:20px;background:#f5f7fb;color:#111}
        header{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}
        .products{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:16px}
        .card{background:#fff;border-radius:8px;padding:12px;box-shadow:0 1px 4px rgba(0,0,0,.08);display:flex;flex-direction:column;gap:8px}
        .name{font-weight:600}
        .price{color:#0a7a5f;font-weight:700}
        button{padding:8px 10px;border:0;border-radius:6px;background:#0078d4;color:#fff;cursor:pointer}
        button[disabled]{opacity:.6;cursor:default}
        .cart{min-width:260px;border-left:1px solid #e6eef6;padding-left:16px}
        .layout{display:flex;gap:20px;align-items:flex-start}
        .cart-list{list-style:none;padding:0;margin:8px 0}
        .cart-item{display:flex;justify-content:space-between;padding:6px 0;border-bottom:1px dashed #e9eef3}
        .muted{color:#6b778c;font-size:.95rem}
        .small{font-size:.9rem}
    </style>
</head>
<body>
    <header>
        <h1>Products</h1>
        <div aria-live="polite" id="cartStatus" class="muted">Cart: 0 items</div>
    </header>

    <div class="layout">
        <main style="flex:1">
            <section id="productGrid" class="products" aria-label="Product list">
                <!-- Products rendered here -->
            </section>
        </main>

        <aside class="cart" aria-label="Shopping cart" style="width:320px">
            <h2 class="small">Shopping Cart</h2>
            <div class="muted small" id="cartTotal">Total: $0.00</div>
            <ul id="cartList" class="cart-list" aria-live="polite"></ul>
            <button id="clearCart" style="background:#d83b01;margin-top:8px">Clear Cart</button>
        </aside>
    </div>

    <script>
        // Sample product array
        const products = [
            { id: 1, name: 'Wireless Mouse', price: 24.99 },
            { id: 2, name: 'Mechanical Keyboard', price: 89.5 },
            { id: 3, name: 'USB-C Hub', price: 34.0 },
            { id: 4, name: '27" Monitor', price: 219.99 },
            { id: 5, name: 'Noise-cancelling Headphones', price: 129.0 }
        ];

        // In-memory cart (array of {id, name, price, qty})
        const cart = [];

        const productGrid = document.getElementById('productGrid');
        const cartList = document.getElementById('cartList');
        const cartStatus = document.getElementById('cartStatus');
        const cartTotal = document.getElementById('cartTotal');
        const clearCartBtn = document.getElementById('clearCart');

        const fmt = new Intl.NumberFormat(undefined, { style: 'currency', currency: 'USD' });

        function renderProducts() {
            productGrid.innerHTML = '';
            products.forEach(p => {
                const card = document.createElement('article');
                card.className = 'card';
                card.innerHTML = `
                    <div class="name">${escapeHtml(p.name)}</div>
                    <div class="price">${fmt.format(p.price)}</div>
                    <div style="margin-top:auto">
                        <button data-id="${p.id}" aria-label="Add ${escapeHtml(p.name)} to cart">Add to Cart</button>
                    </div>
                `;
                productGrid.appendChild(card);
            });
        }

        function escapeHtml(str) {
            return String(str).replace(/[&<>"']/g, s => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[s]));
        }

        function addToCart(productId) {
            const prod = products.find(p => p.id === productId);
            if (!prod) return;
            const existing = cart.find(i => i.id === productId);
            if (existing) {
                existing.qty += 1;
            } else {
                cart.push({ id: prod.id, name: prod.name, price: prod.price, qty: 1 });
            }
            renderCart();
        }

        function removeFromCart(productId) {
            const idx = cart.findIndex(i => i.id === productId);
            if (idx === -1) return;
            cart.splice(idx, 1);
            renderCart();
        }

        function renderCart() {
            cartList.innerHTML = '';
            let total = 0;
            let items = 0;
            cart.forEach(item => {
                total += item.price * item.qty;
                items += item.qty;
                const li = document.createElement('li');
                li.className = 'cart-item';
                li.innerHTML = `
                    <div>
                        <div style="font-weight:600">${escapeHtml(item.name)}</div>
                        <div class="muted small">${item.qty} Ã— ${fmt.format(item.price)}</div>
                    </div>
                    <div style="text-align:right">
                        <div>${fmt.format(item.price * item.qty)}</div>
                        <button data-remove="${item.id}" style="margin-top:6px;background:#e11; padding:6px;border-radius:6px">Remove</button>
                    </div>
                `;
                cartList.appendChild(li);
            });
            cartStatus.textContent = `Cart: ${items} item${items !== 1 ? 's' : ''}`;
            cartTotal.textContent = `Total: ${fmt.format(total)}`;
        }

        // Event delegation for Add to Cart and Remove
        productGrid.addEventListener('click', (e) => {
            const btn = e.target.closest('button[data-id]');
            if (!btn) return;
            const id = Number(btn.getAttribute('data-id'));
            addToCart(id);
        });

        cartList.addEventListener('click', (e) => {
            const btn = e.target.closest('button[data-remove]');
            if (!btn) return;
            const id = Number(btn.getAttribute('data-remove'));
            removeFromCart(id);
        });

        clearCartBtn.addEventListener('click', () => {
            cart.length = 0;
            renderCart();
        });

        // Initial render
        renderProducts();
        renderCart();
    </script>
</body>
</html>